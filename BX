--// SERVICES
local UserInputService = game:GetService("UserInputService")
local VirtualInputManager = game:GetService("VirtualInputManager")

--// SCREEN GUI & BUTTON
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui

local ToggleButton = Instance.new("TextButton")
ToggleButton.Name = "ToggleUIButton"
ToggleButton.Parent = ScreenGui
ToggleButton.BackgroundColor3 = Color3.new(1, 1, 1)     -- White background
ToggleButton.BorderSizePixel = 2                       -- Black border
ToggleButton.BorderColor3 = Color3.new(0, 0, 0)        -- Black edges
ToggleButton.Size = UDim2.new(0, 50, 0, 50)            -- Circle dimensions
ToggleButton.Text = "ğŸ§"
ToggleButton.Font = Enum.Font.SourceSans
ToggleButton.TextSize = 24
ToggleButton.TextColor3 = Color3.new(0, 0, 0)
ToggleButton.ClipsDescendants = true

-- Position near the left edge (30 px from left, vertically centered)
ToggleButton.AnchorPoint = Vector2.new(0.5, 0.5)
ToggleButton.Position = UDim2.new(0, 30, 0.5, 0)

-- Make it a circle
local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(1, 0)
uiCorner.Parent = ToggleButton

--// DRAGGING & CLICK/TOUCH THRESHOLD
local dragging = false
local dragInput = nil
local dragStart = nil
local startPos = nil

-- We'll use this to distinguish a tap from a drag.
local isPressing = false
local pressPos = nil
local movedThreshold = 10  -- The distance (pixels) beyond which it counts as a drag.

-- Store the button's last position and size, so we can shrink/grow from wherever the user left it.
local lastPosition = ToggleButton.Position
local lastSize = ToggleButton.Size

--// DRAG UPDATE FUNCTION
local function updateDrag(input)
    local delta = input.Position - dragStart
    ToggleButton.Position = UDim2.new(
        startPos.X.Scale,
        startPos.X.Offset + delta.X,
        startPos.Y.Scale,
        startPos.Y.Offset + delta.Y
    )
end

--// INPUT BEGAN
ToggleButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 
       or input.UserInputType == Enum.UserInputType.Touch then
       
        dragging = false
        isPressing = true
        pressPos = input.Position
        
        dragStart = input.Position
        startPos = ToggleButton.Position
        
        -- Stop dragging when input ends
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

--// INPUT CHANGED
ToggleButton.InputChanged:Connect(function(input)
    -- Dragging with mouse or touch
    if input.UserInputType == Enum.UserInputType.MouseMovement 
       or input.UserInputType == Enum.UserInputType.Touch then
       
        dragInput = input
    end

    -- If the user moved more than 'movedThreshold' pixels, treat as a drag
    if isPressing and pressPos and input.Position then
        local distanceMoved = (input.Position - pressPos).magnitude
        if distanceMoved > movedThreshold then
            dragging = true
        end
    end
end)

--// GLOBAL INPUT CHANGED
UserInputService.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        updateDrag(input)
    end
end)

--// INPUT ENDED
ToggleButton.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 
       or input.UserInputType == Enum.UserInputType.Touch then
       
        isPressing = false
        -- If we never exceeded the threshold, treat as a tap/click
        if not dragging then
            -- Only simulate the 'K' key if we're not on a touch-only device
            if not UserInputService.TouchEnabled then
                VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.K, false, game)
                wait(0.1)
                VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.K, false, game)
            end
            -- Shrink and disappear
            shrinkAndDisappear()
        end
    end
end)

--// SHRINK & DISAPPEAR
function shrinkAndDisappear()
    -- Record the button's current position & size
    lastPosition = ToggleButton.Position
    lastSize = ToggleButton.Size

    local startSizeX = lastSize.X.Offset
    local startSizeY = lastSize.Y.Offset
    local steps = 10

    for i = 1, steps do
        local ratio = 1 - (i / steps)
        local newX = startSizeX * ratio
        local newY = startSizeY * ratio
        ToggleButton.Size = UDim2.new(0, newX, 0, newY)
        -- Keep the position the same so it shrinks in place
        ToggleButton.Position = lastPosition
        wait(0.05)
    end

    ToggleButton.Visible = false
end

--// GROW & APPEAR
function growAndAppear()
    -- Restore visibility
    ToggleButton.Visible = true
    ToggleButton.Position = lastPosition

    local finalSizeX = lastSize.X.Offset
    local finalSizeY = lastSize.Y.Offset
    local steps = 10

    -- Start from 0, grow up to final size
    for i = 1, steps do
        local ratio = i / steps
        local newX = finalSizeX * ratio
        local newY = finalSizeY * ratio
        ToggleButton.Size = UDim2.new(0, newX, 0, newY)
        ToggleButton.Position = lastPosition
        wait(0.05)
    end
end

-- Rayfield

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "BLUE [NEW] V1",
    LoadingTitle = "SKYBLUEX",
    LoadingSubtitle = "By your brother",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "Big Hub"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink",
        RememberJoins = true
    },
    KeySystem = false,
    KeySettings = {
        Title = "Untitled",
        Subtitle = "Key System",
        Note = "No method of obtaining the key is provided",
        FileName = "Key",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {"Hello"}
    }
})

-- Tabs

local BlueTab = Window:CreateTab("ğŸ§", 4483362458) -- Title, Image

local RoxTab = Window:CreateTab("â›„", 4483362458) -- Title, Image

local RexTab = Window:CreateTab("ğŸ§™â€â™‚ï¸", 4483362458) -- Title, Image



-- Buttons
-- Blue

local Button = BlueTab:CreateButton({
   Name = "IY",
   Callback = function(Value)
   loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
   end,
})

local Button = BlueTab:CreateButton({
   Name = "Fly",
   Callback = function(Value)
   loadstring(game:HttpGet("https://pastebin.com/raw/ZxLiHtYN"))()
   end,
})

local Button = BlueTab:CreateButton({
   Name = "Fly [ADMIN]",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://pastebin.com/raw/YvKv4AuY'),true))();
   end,
})

local Button = BlueTab:CreateButton({
   Name = "rochips universal",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://raw.githubusercontent.com/randomstring0/Qwerty/main/qwerty4'),true))();
   end,
})

local Button = BlueTab:CreateButton({
   Name = "Fly Gui V4",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/TheBlue5/My-scripts/refs/heads/main/Fly%20Gui%20V4"))();
   end,
})

local Button = BlueTab:CreateButton({
   Name = "Vfly V2",
   Callback = function(Value)
   loadstring(game:HttpGet('https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Vehicle%20Fly%20Gui'))()
   end,
})

local Button = BlueTab:CreateButton({
   Name = "Vfly XX",
   Callback = function(Value)
   loadstring(game:HttpGet('https://raw.githubusercontent.com/ScpGuest666/Custom-stuff/refs/heads/main/Vehicle%20Fly%20script%20testing'))()
   end,
})

local Button = BlueTab:CreateButton({
   Name = "Vfly V4",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://pastebin.com/raw/ZgKQ0TEA'),true))()
   end,
})

local Button = BlueTab:CreateButton({
   Name = "Fling speed ğŸ¥",
   Callback = function(Value)
   loadstring(game:HttpGet('https://pastebin.com/raw/r97d7dS0', true))()
   end,
})

-- Rox

local Button = RoxTab:CreateButton({
   Name = "âœ…",
   Callback = function(Value)
   loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "âœˆï¸",
   Callback = function(Value)
   loadstring(game:HttpGet("https://pastebin.com/raw/ZxLiHtYN"))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "âœˆï¸ 2",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://pastebin.com/raw/YvKv4AuY'),true))();
   end,
})

local Button = RoxTab:CreateButton({
   Name = "âœˆï¸ 3",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://pastebin.com/raw/ZgKQ0TEA'),true))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "âœˆï¸ğŸš—",
   Callback = function(Value)
   loadstring(game:HttpGet('https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Vehicle%20Fly%20Gui'))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "âœˆï¸ V4",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/TheBlue5/My-scripts/refs/heads/main/Fly%20Gui%20V4"))();
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸ’ƒ",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://raw.githubusercontent.com/randomstring0/Qwerty/main/qwerty4'),true))();
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸŸ©",
   Callback = function(Value)
   loadstring(game:HttpGet"https://raw.githubusercontent.com/Basicallyy/Basicallyy/main/MinGamingV4.lua")()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "â¬œ",
   Callback = function(Value)
   loadstring(game:HttpGet("https://pastebin.com/raw/TjjnpCM1"))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸ”´",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/REDzHUB/BloxFruits/main/redz9999"))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸğŸğŸ",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/DHBCommunity/DHBOfficialScript/main/westyourballz"))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸ’ƒğŸ’ƒğŸ’ƒ ",
   Callback = function(Value)
   loadstring(game:HttpGet("https://pastebin.com/raw/eCpipCTH"))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "mm2ğŸ‘ï¸",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://pastebin.com/raw/CMN1fPhw'),true))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸ¡ğŸ¡ğŸ¡",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/RFR-R1CH4RD/Loader/main/Salvatore.lua"))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸ•·ï¸ğŸ•·ï¸ğŸ•·ï¸",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/0Ben1/fe/main/obf_E872F3ky4888TSVdj6Adgi1hSLtM038AyxVpTVw07QA3QUDcI3sxmuD869hYR4id.lua.txt"))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸ§ğŸ§ğŸ§",
   Callback = function(Value)
   loadstring(game:HttpGet("https://scriptblox.com/raw/FE-Animation-Changer_217"))()
   end,
})

local Button = RoxTab:CreateButton({
   Name = "ğŸ”¨ğŸ”¨ğŸ”¨",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/Drifty96/ftfgui/main/ftfgui", true))()
   end,
})

-- Rex Tab

local Button = RexTab:CreateButton({
   Name = "âœ…",
   Callback = function(Value)
   loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "âœˆï¸",
   Callback = function(Value)
   loadstring(game:HttpGet("https://pastebin.com/raw/ZxLiHtYN"))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "âœˆï¸ 2",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://pastebin.com/raw/YvKv4AuY'),true))();
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸ’ƒ",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://raw.githubusercontent.com/randomstring0/Qwerty/main/qwerty4'),true))();
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸŸ©",
   Callback = function(Value)
   loadstring(game:HttpGet"https://raw.githubusercontent.com/Basicallyy/Basicallyy/main/MinGamingV4.lua")()
   end,
})

local Button = RexTab:CreateButton({
   Name = "â¬œ",
   Callback = function(Value)
   loadstring(game:HttpGet("https://pastebin.com/raw/TjjnpCM1"))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸ”´",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/REDzHUB/BloxFruits/main/redz9999"))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸğŸğŸ",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/DHBCommunity/DHBOfficialScript/main/westyourballz"))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸ’ƒğŸ’ƒğŸ’ƒ ",
   Callback = function(Value)
   loadstring(game:HttpGet("https://pastebin.com/raw/eCpipCTH"))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "mm2ğŸ‘ï¸",
   Callback = function(Value)
   loadstring(game:HttpGet(('https://pastebin.com/raw/CMN1fPhw'),true))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸ¡ğŸ¡ğŸ¡",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/RFR-R1CH4RD/Loader/main/Salvatore.lua"))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸ•·ï¸ğŸ•·ï¸ğŸ•·ï¸",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/0Ben1/fe/main/obf_E872F3ky4888TSVdj6Adgi1hSLtM038AyxVpTVw07QA3QUDcI3sxmuD869hYR4id.lua.txt"))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸ§ğŸ§ğŸ§",
   Callback = function(Value)
   loadstring(game:HttpGet("https://scriptblox.com/raw/FE-Animation-Changer_217"))()
   end,
})

local Button = RexTab:CreateButton({
   Name = "ğŸ”¨ğŸ”¨ğŸ”¨",
   Callback = function(Value)
   loadstring(game:HttpGet("https://raw.githubusercontent.com/Drifty96/ftfgui/main/ftfgui", true))()
   end,
})

-- key

local Keybind = BlueTab:CreateKeybind({
   Name = "Keybind Example",
   CurrentKeybind = "K", -- Changed to K
   HoldToInteract = false,
   Flag = "Keybind1", -- A flag is the identifier for the configuration file, make sure every element has a different flag if you're using configuration saving to ensure no overlaps
   Callback = function(Keybind)
   -- The function that takes place when the keybind is pressed
   -- The variable (Keybind) is a boolean for whether the keybind is being held or not (HoldToInteract needs to be true)
   end,
})